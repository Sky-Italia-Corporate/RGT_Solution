<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/7/2011 3:56:51 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="HYPSRV-SVIL01"
  DTS:CreatorName="SKY\vennia"
  DTS:DTSID="{6EA43BE3-C258-422F-AD9A-3D7E6FAE52E7}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3002.113"
  DTS:LocaleID="1033"
  DTS:ObjectName="SKY_RGT_1_02_02_SF_FACT_PLAYS_BCK_20131017"
  DTS:PackageType="5"
  DTS:VersionBuild="31"
  DTS:VersionGUID="{A582812D-12AB-4F1B-8E85-FA6BD4CD370A}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[(local).ICO_MONITOR]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{3C54FDCD-22B7-4EDB-AB39-37A39E2B8AED}"
      DTS:ObjectName="(local).ICO_MONITOR">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=SQL01;Initial Catalog=ICO_MONITOR;Provider=SQLNCLI11;Integrated Security=SSPI;Auto Translate=False;Application Name=SSIS-SKY_RGT_1_02_02_SF_FACT_PLAYS-{3C54FDCD-22B7-4EDB-AB39-37A39E2B8AED}(local).ICO_MONITOR;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[(local).SKY_RGT]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{B2B5CD37-6226-4681-882E-3B28F859B633}"
      DTS:ObjectName="(local).SKY_RGT">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=SQL01;Initial Catalog=SKY_RGT;Provider=SQLNCLI11;Integrated Security=SSPI;Auto Translate=False;Application Name=SSIS-SKY_RGT_1_02_02_SF_FACT_PLAYS-{B2B5CD37-6226-4681-882E-3B28F859B633}(local).SKY_RGT;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="(local).ICO_MONITOR"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{00FB2558-D9C3-4695-B4FF-E4CD57C714BA}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">6,7,OnError,13,OnPostExecute,14,OnPostValidate,12,OnPreExecute,13,OnPreValidate,12,OnTaskFailed</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPostExecute"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPostValidate"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPreExecute"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPreValidate"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnTaskFailed"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{00FB2558-D9C3-4695-B4FF-E4CD57C714BA}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Create SF_PASSAGGI_IBMS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{7741545B-18A6-4182-B998-7457D7AE137C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Create SF_PASSAGGI_IBMS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B2B5CD37-6226-4681-882E-3B28F859B633}"
          SQLTask:SqlStatementSource="use [SKY_RGT]&#xA;-- vengono scartati i record con Purchase ID non valorizzato --&#xA;&#xA;/****** Object:  Table [dbo].[E_IBMS_PASSAGGI]    Script Date: 01/12/2011 11:00:18 ******/&#xA;IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[E_IBMS_PASSAGGI]') AND type in (N'U'))&#xA;DROP TABLE [dbo].[E_IBMS_PASSAGGI]&#xA;GO&#xA;&#xA;select *&#xA;into E_IBMS_PASSAGGI&#xA;from T_IBMS_PASSAGGI&#xA;where [Purchase Id] is null or [Purchase Id]='' or [Purchase Id]=' '&#xA;&#xA;declare @SCENARIO int&#xA;&#xA;set @SCENARIO=0 --0 sarà lo scenario su cui verranno caricati tutti i passaggi &#xA;&#xA;select &#xA;cast(TITOLO.BDG_COD as varchar(11)) as BDG_COD,&#xA;cast(@SCENARIO as int) as SCE_COD,&#xA;cast(1 as int) as DAT_TYP_ID,&#xA;cast(ltrim(rtrim([Purchase Id])) as int) as PUR_COD, &#xA;[Schedule Date] as PAS_SCH_DAT, &#xA;convert(datetime, ltrim(rtrim([Schedule Date])), 112) as PAS_SCH_DAT_DATETIME,&#xA;ltrim(rtrim([Start Time])) as PAS_STA_TIM, &#xA;ltrim(rtrim([Schedule Datetime])) as PAS_SCH_DAT_TIM, &#xA;cast(ltrim(rtrim([Channel Code])) as varchar(50)) as PAS_CHA_COD, &#xA;cast(ltrim(rtrim([Transmitted])) as varchar(50)) as PAS_TRA,&#xA;cast(1 as int) as PAS_NUM_PLA_SCH&#xA;into #T_IBMS_PASSAGGI&#xA;from T_IBMS_PASSAGGI PASSAGGI&#xA;left join SF_TITOLO TITOLO on cast(ltrim(rtrim(PASSAGGI.[Purchase Id])) as int)=TITOLO.PUR_COD&#xA;&#xA;&#xA;-- Variabili in cui viene salvato il range temporale  &#xA;-- dei dati che stiamo ricaricando&#xA;&#xA;declare @MIN_PERIOD int&#xA;declare @MAX_PERIOD int&#xA;&#xA;set @MIN_PERIOD=(select min([Schedule Date]) from T_IBMS_PASSAGGI)&#xA;set @MAX_PERIOD=(select max([Schedule Date]) from T_IBMS_PASSAGGI)&#xA;&#xA;update dbo.S_IBMS_PASSAGGI_MAX_DATE&#xA;set DAY_LAST_DAT = @MAX_PERIOD&#xA;&#xA;update dbo.S_IBMS_PASSAGGI_MAX_DATE&#xA;set DAY_MAX_DAT = @MAX_PERIOD&#xA;where @MAX_PERIOD &gt; DAY_MAX_DAT&#xA;&#xA;&#xA;&#xA;select BDG_COD, &#xA;SCE_COD, &#xA;DAT_TYP_ID, &#xA;PUR_COD, &#xA;PAS_SCH_DAT, &#xA;PAS_SCH_DAT_DATETIME, &#xA;PAS_STA_TIM, &#xA;PAS_SCH_DAT_TIM, &#xA;PAS_CHA_COD, &#xA;PAS_TRA, &#xA;PAS_NUM_PLA_SCH&#xA;into #SF_PASSAGGI_IBMS&#xA;from dbo.SF_PASSAGGI_IBMS&#xA;where (SCE_COD=@SCENARIO and DAT_TYP_ID=1 and (PAS_SCH_DAT&lt;@MIN_PERIOD or PAS_SCH_DAT&gt;@MAX_PERIOD)) or (SCE_COD&lt;&gt;@SCENARIO)&#xA;&#xA;&#xA;&#xA;USE [SKY_RGT]&#xA;GO&#xA;&#xA;/****** Object:  Table [dbo].[SF_PASSAGGI_IBMS]    Script Date: 01/05/2011 18:00:50 ******/&#xA;IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SF_PASSAGGI_IBMS]') AND type in (N'U'))&#xA;DROP TABLE [dbo].[SF_PASSAGGI_IBMS]&#xA;GO&#xA;&#xA;&#xA;select &#xA;BDG_COD, &#xA;SCE_COD, &#xA;DAT_TYP_ID, &#xA;PUR_COD, &#xA;PAS_SCH_DAT, &#xA;PAS_SCH_DAT_DATETIME, &#xA;PAS_STA_TIM, &#xA;PAS_SCH_DAT_TIM, &#xA;PAS_CHA_COD, &#xA;PAS_TRA, &#xA;PAS_NUM_PLA_SCH&#xA;into dbo.SF_PASSAGGI_IBMS&#xA;from #SF_PASSAGGI_IBMS&#xA;union&#xA;select &#xA;BDG_COD, &#xA;SCE_COD, &#xA;DAT_TYP_ID, &#xA;PUR_COD, &#xA;PAS_SCH_DAT, &#xA;PAS_SCH_DAT_DATETIME, &#xA;PAS_STA_TIM, &#xA;PAS_SCH_DAT_TIM, &#xA;PAS_CHA_COD, &#xA;PAS_TRA, &#xA;PAS_NUM_PLA_SCH&#xA;from #T_IBMS_PASSAGGI&#xA;&#xA;&#xA;DROP TABLE #T_IBMS_PASSAGGI&#xA;&#xA;DROP TABLE #SF_PASSAGGI_IBMS" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PackageVariables>
    <DTS:PackageVariable
      DTS:CreationName=""
      DTS:DTSID="{3BD1F4CE-1262-4421-8A06-877D38A67745}"
      DTS:Namespace="dts-designer-1.0"
      DTS:ObjectName="package-diagram">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="PackageVariableValue">&lt;Package xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ddl2="http://schemas.microsoft.com/analysisservices/2003/engine/2" xmlns:ddl2_2="http://schemas.microsoft.com/analysisservices/2003/engine/2/2" xmlns:ddl100_100="http://schemas.microsoft.com/analysisservices/2008/engine/100/100" xmlns:ddl200="http://schemas.microsoft.com/analysisservices/2010/engine/200" xmlns:ddl200_200="http://schemas.microsoft.com/analysisservices/2010/engine/200/200" xmlns:dwd="http://schemas.microsoft.com/DataWarehouse/Designer/1.0"&gt;&lt;dwd:DtsControlFlowDiagram&gt;&lt;dwd:Layout&gt;&lt;dds&gt;&lt;diagram fontclsid="{0BE35203-8F91-11CE-9DE3-00AA004BB851}" mouseiconclsid="{0BE35204-8F91-11CE-9DE3-00AA004BB851}" defaultlayout="Microsoft.DataWarehouse.Layout.GraphLayout110" defaultlineroute="Microsoft.DataWarehouse.Layout.GraphLayout110" version="7" nextobject="5" scale="100" pagebreakanchorx="0" pagebreakanchory="0" pagebreaksizex="0" pagebreaksizey="0" scrollleft="0" scrolltop="0" gridx="150" gridy="150" marginx="1000" marginy="1000" zoom="100" x="19870" y="11245" backcolor="15334399" defaultpersistence="2" PrintPageNumbersMode="3" PrintMarginTop="0" PrintMarginBottom="635" PrintMarginLeft="0" PrintMarginRight="0" marqueeselectionmode="1" mousepointer="0" snaptogrid="0" autotypeannotation="1" showscrollbars="0" viewpagebreaks="0" donotforceconnectorsbehindshapes="1" backpictureclsid="{00000000-0000-0000-0000-000000000000}"&gt;&lt;font&gt;&lt;ddsxmlobjectstreamwrapper binary="01010000900180380100065461686f6d61" /&gt;&lt;/font&gt;&lt;mouseicon&gt;&lt;ddsxmlobjectstreamwrapper binary="6c74000000000000" /&gt;&lt;/mouseicon&gt;&lt;/diagram&gt;&lt;layoutmanager&gt;&lt;ddsxmlobj /&gt;&lt;/layoutmanager&gt;&lt;ddscontrol controlprogid="DdsShapes.DdsObjectManagedBridge.2" tooltip="Execute SQL Task" left="4511" top="5159" logicalid="2" controlid="1" masterid="0" hint1="0" hint2="0" width="6641" height="1164" noresize="0" nomove="0" nodefaultattachpoints="0" autodrag="1" usedefaultiddshape="1" selectable="1" showselectionhandles="1" allownudging="1" isannotation="0" dontautolayout="0" groupcollapsed="0" tabstop="1" visible="1" snaptogrid="0"&gt;&lt;control&gt;&lt;ddsxmlobjectstreaminitwrapper binary="00080000f11900008c040000" /&gt;&lt;/control&gt;&lt;layoutobject&gt;&lt;ddsxmlobj&gt;&lt;property name="LogicalObject" value="Package\Create SF_PASSAGGI_IBMS" vartype="8" /&gt;&lt;property name="ShowConnectorSource" value="0" vartype="2" /&gt;&lt;/ddsxmlobj&gt;&lt;/layoutobject&gt;&lt;shape groupshapeid="0" groupnode="0" /&gt;&lt;/ddscontrol&gt;&lt;/dds&gt;&lt;/dwd:Layout&gt;&lt;/dwd:DtsControlFlowDiagram&gt;&lt;/Package&gt;</DTS:Property>
    </DTS:PackageVariable>
    <DTS:PackageVariable
      DTS:CreationName=""
      DTS:DTSID="{BFB7C6FB-76A3-4FFC-B775-5FD85307EA3F}"
      DTS:Namespace="dts-designer-1.0"
      DTS:ObjectName="package-diagram">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="PackageVariableValue">&lt;Package xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ddl2="http://schemas.microsoft.com/analysisservices/2003/engine/2" xmlns:ddl2_2="http://schemas.microsoft.com/analysisservices/2003/engine/2/2" xmlns:ddl100_100="http://schemas.microsoft.com/analysisservices/2008/engine/100/100" xmlns:ddl200="http://schemas.microsoft.com/analysisservices/2010/engine/200" xmlns:ddl200_200="http://schemas.microsoft.com/analysisservices/2010/engine/200/200" xmlns:dwd="http://schemas.microsoft.com/DataWarehouse/Designer/1.0"&gt;&lt;dwd:DtsControlFlowDiagram&gt;&lt;dwd:Layout&gt;&lt;dds&gt;&lt;diagram fontclsid="{0BE35203-8F91-11CE-9DE3-00AA004BB851}" mouseiconclsid="{0BE35204-8F91-11CE-9DE3-00AA004BB851}" defaultlayout="Microsoft.DataWarehouse.Layout.GraphLayout110" defaultlineroute="Microsoft.DataWarehouse.Layout.GraphLayout110" version="7" nextobject="5" scale="100" pagebreakanchorx="0" pagebreakanchory="0" pagebreaksizex="0" pagebreaksizey="0" scrollleft="0" scrolltop="0" gridx="150" gridy="150" marginx="1000" marginy="1000" zoom="100" x="19870" y="11245" backcolor="15334399" defaultpersistence="2" PrintPageNumbersMode="3" PrintMarginTop="0" PrintMarginBottom="635" PrintMarginLeft="0" PrintMarginRight="0" marqueeselectionmode="1" mousepointer="0" snaptogrid="0" autotypeannotation="1" showscrollbars="0" viewpagebreaks="0" donotforceconnectorsbehindshapes="1" backpictureclsid="{00000000-0000-0000-0000-000000000000}"&gt;&lt;font&gt;&lt;ddsxmlobjectstreamwrapper binary="01010000900180380100065461686f6d61" /&gt;&lt;/font&gt;&lt;mouseicon&gt;&lt;ddsxmlobjectstreamwrapper binary="6c74000000000000" /&gt;&lt;/mouseicon&gt;&lt;/diagram&gt;&lt;layoutmanager&gt;&lt;ddsxmlobj /&gt;&lt;/layoutmanager&gt;&lt;ddscontrol controlprogid="DdsShapes.DdsObjectManagedBridge.2" tooltip="Execute SQL Task" left="4511" top="5159" logicalid="2" controlid="1" masterid="0" hint1="0" hint2="0" width="6641" height="1164" noresize="0" nomove="0" nodefaultattachpoints="0" autodrag="1" usedefaultiddshape="1" selectable="1" showselectionhandles="1" allownudging="1" isannotation="0" dontautolayout="0" groupcollapsed="0" tabstop="1" visible="1" snaptogrid="0"&gt;&lt;control&gt;&lt;ddsxmlobjectstreaminitwrapper binary="00080000f11900008c040000" /&gt;&lt;/control&gt;&lt;layoutobject&gt;&lt;ddsxmlobj&gt;&lt;property name="LogicalObject" value="Package\Create SF_PASSAGGI_IBMS" vartype="8" /&gt;&lt;property name="ShowConnectorSource" value="0" vartype="2" /&gt;&lt;/ddsxmlobj&gt;&lt;/layoutobject&gt;&lt;shape groupshapeid="0" groupnode="0" /&gt;&lt;/ddscontrol&gt;&lt;/dds&gt;&lt;/dwd:Layout&gt;&lt;/dwd:DtsControlFlowDiagram&gt;&lt;/Package&gt;</DTS:Property>
    </DTS:PackageVariable>
  </DTS:PackageVariables>
</DTS:Executable>